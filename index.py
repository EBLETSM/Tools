import base64
exec(base64.b64decode("ZnJvbSBjb2xvcmFtYSBpbXBvcnQgRm9yZQpmcm9tIHB5bmdyb2sgaW1wb3J0IG5ncm9rCmltcG9ydCByZXF1ZXN0cywgb3MsIHRpbWUsIHN5cwppbXBvcnQgc29ja2V0CiMgWyBDaXBoZXJYIF0gIwpSID0gJ1wwMzNbMzFtJyAjIHJlZApHID0gJ1wwMzNbMzJtJyAjIGdyZWVuCkMgPSAnXDAzM1szNm0nICMgY3lhbgpXID0gJ1wwMzNbMG0nICAjIHdoaXRlCiMgWyBDaXBoZXIgIF0gIwpkZWYgU3RhcnQoKToKCXRyeToKCQlvcy5zeXN0ZW0oJ2NsZWFyJyBvciAiY2xzIikKCQlwcmludChGb3JlLlJFRCsiV2VsY29tZSA6KSIpCgkJdGltZS5zbGVlcCgwKQoJCW9zLnN5c3RlbSgnY2xlYXInIG9yICJjbHMiKQoJCXByaW50KEZvcmUuUkVEKyJbIE1lIF0tPiBAQ2lwaGVyWCIpCgkJcHJpbnQoRm9yZS5HUkVFTisiWytdIEhlbGxvIGFuZCB3ZWxjb21lIHRvIHRoZSBDaXBoZXJYIHRvb2xcbiIrRm9yZS5SRUQrIjw9PT09PT09PT0+IikKCQlwcmludChGb3JlLkNZQU4rIlsxXS0+IEF0dGFjayBpcFxuWzJdLT4gRERPU1xuWzNdLT4gc21zIEJvbWJlclxuWzRdLT4gSGFjayBDYW1cbls1XS0+IE15IElQXG4iK0ZvcmUuR1JFRU4rIls2XS0+IEV4aXRcbiIrRm9yZS5SRUQrIjw9PT09PT09PT0+XG4iKQoJCWVudGVyID0gc3RyKGlucHV0KEZvcmUuR1JFRU4rIkVOVEVSIDo+ICIpKQoJCWlmIGVudGVyID09ICIxIjoKCQkJb3Muc3lzdGVtKCdjbGVhcicgb3IgImNscyIpCgkJCXByaW50KEZvcmUuR1JFRU4rIlsrXSBBdHRhY2sgaXAgwqwiKQoJCQlwcmludChGb3JlLkdSRUVOKyJbK10tPiBAQ2lwaGVyWCDCrCIpCgkJCXByaW50KEZvcmUuUkVEKyI8PT09PT09PT09PiIpCgkJCUF0dGFjayA9IHN0cihpbnB1dChGb3JlLkNZQU4rIkJhY2sgTWVudSBMaXN0IDwgOTkgPiBJUCA6PiAiKSkKCQkJaWYgQXR0YWNrID09ICI5OSI6CgkJCQlvcy5zeXN0ZW0oImNsZWFyIikKCQkJCVN0YXJ0KCkKCQkJdGltZS5zbGVlcCgzKQoJCQlwcmludChGb3JlLlJFRCsiPD09PT09PT09PT4iKQoJCQlmb3IgaSBpbiByYW5nZSgwLDEwMCk6CgkJCQlzZW5kID0gc29ja2V0LmdldGhvc3RieW5hbWUoQXR0YWNrKQoJCQkJcHJpbnQoRm9yZS5HUkVFTisiQVRUQUsgSVAgOiB7fSIuZm9ybWF0KEZvcmUuUkVEK3NlbmQpKQoJCQkJdGltZS5zbGVlcCgyKQkKCQlpZiBlbnRlciA9PSAiMiI6CgkJCW9zLnN5c3RlbSgnY2xlYXInIG9yICJjbHMiKQoJCQlwcmludChGb3JlLkdSRUVOKyJbK10gRERPUyDCrCIpCgkJCXByaW50KEZvcmUuR1JFRU4rIlsrXS0+IEBDaXBoZXJYIMKsIikKCQkJcHJpbnQoRm9yZS5SRUQrIjw9PT09PT09PT0+IikKCQkJZGRvcyA9IHN0cihpbnB1dChGb3JlLkNZQU4rIkJhY2sgTWVudSBMaXN0IDwgOTkgPiBTSVRFIDo+ICIpKQoJCQlpZiBkZG9zID09ICI5OSI6CgkJCQlvcy5zeXN0ZW0oJ2NsZWFyJykKCQkJCVN0YXJ0KCkKCQkJc29jID0gc29ja2V0LmdldGhvc3RieW5hbWUoZGRvcykKCQkJdGltZS5zbGVlcCgzKQoJCQlwcmludChGb3JlLlJFRCsiPD09PT09KCB7fSApPT09PT0+Ii5mb3JtYXQoZGRvcykpCgkJCWZvciBhIGluIHJhbmdlKDAsMTAwKToKCQkJCXByaW50KEZvcmUuR1JFRU4rIkRET1MgOiB7fSIuZm9ybWF0KEZvcmUuUkVEK3NvYykpCgkJCQl0aW1lLnNsZWVwKDIpCgkJaWYgZW50ZXIgPT0gIjMiOgoJCQlvcy5zeXN0ZW0oJ2NsZWFyJyBvciAiY2xzIikKCQkJcHJpbnQoRm9yZS5HUkVFTisiWytdIFNNUyBCb21iZXIgwqwiKQoJCQlwcmludChGb3JlLkdSRUVOKyJbK10tPiBAQ2lwaGVyWCDCrCIpCgkJCXByaW50KEZvcmUuUkVEKyI8PT09PT09PT09PiIpCgkJCXNtcyA9IHN0cihpbnB1dChGb3JlLkNZQU4rIkJhY2sgTWVudSBMaXN0IDwgOTkgPiBQSE9ORSA6PiAiKSkKCQkJaWYgc21zID09ICI5OSI6CgkJCQlvcy5zeXN0ZW0oImNsZWFyIikKCQkJCVN0YXJ0KCkKCQkJdGltZS5zbGVlcCgzKQoJCQlwcmludChGb3JlLlJFRCsiPD09PT09KCB7fSApPT09PT0+Ii5mb3JtYXQoc21zKSkKCQkJZm9yIHMgaW4gcmFuZ2UoMCwxMDApOgoJCQkJcHJpbnQoRm9yZS5HUkVFTisiU01TIFNFTkQgOiB7fSIuZm9ybWF0KEZvcmUuUkVEK3NtcykpCgkJCQl0aW1lLnNsZWVwKDIpCgkJaWYgZW50ZXIgPT0gIjQiOgoJCQlvcy5zeXN0ZW0oJ2NsZWFyJyBvciAiY2xzIikKCQkJcHJpbnQoRm9yZS5HUkVFTisiWytdIEhhY2sgQ2FtIMKsIikKCQkJcHJpbnQoRm9yZS5HUkVFTisiWytdLT4gQENpcGhlclggwqwiKQoJCQlwcmludChGb3JlLlJFRCsiPD09PT09PT09PT4iKQoJCQlwcmludChGb3JlLkNZQU4rIlsxXSBTZXJ2ZXJcblsyXSBOZ3Jva1xuIikKCQkJbmdyb2sxID0gc3RyKGlucHV0KEZvcmUuR1JFRU4rIkVOVEVSIDo+ICIpKQoJCQlpZiBuZ3JvazEgPT0gIjEiOgoJCQkJU2VydmVyID0gc3RyKGlucHV0KEZvcmUuWUVMTE9XKyJCYWNrIE1lbnUgTGlzdCA8IDk5ID4gWyBTZXJ2ZXIgXSAtIFNlcnZlciA6PiAiKSkKCQkJCWlmIFNlcnZlciA9PSAiOTkiOgoJCQkJCW9zLnN5c3RlbSgnY2xlYXInKQoJCQkJCVN0YXJ0KCkKCQkJCXByaW50KEZvcmUuUkVEKyJbIFNlcnZlciBMb2dpbiB7fSBdIi5mb3JtYXQoU2VydmVyKSkKCQkJCVNlcnZlcjEgPSBzdHIoaW5wdXQoRm9yZS5HUkVFTisiVVNFUiA6PiAiKSkKCQkJCVNlcnZlcjIgPSBzdHIoaW5wdXQoRm9yZS5HUkVFTisiUEFTUyA6PiAiKSkKCQkJCXRpbWUuc2xlZXAoNDApCgkJCQlzeXMuZXhpdCgpCgkJCWlmIG5ncm9rMSA9PSAiMiI6CgkJCQlvcy5zeXN0ZW0oInBocCAtUyBsb2NhbGhvc3Q6Ly84MDgwIikKCQkJCXByaW50KEZvcmUuWUVMTE9XKyJbIFJ1biBTZXJ2ZXIgcGhwIF0iKQoJCQkJcHJpbnQoRm9yZS5SRUQrIlsgUnVuIE5ncm9rIFNlcnZlciBdIikKCQkJCXByaW50KCJbIExpbmsgXSDCrCIpCgkJCQlwdWJsaWMgPSBzdHIobmdyb2suY29ubmVjdCg4MDgwLCJodHRwIikpCgkJCQlwcmludChzdHIocHVibGljKSkKCQkJCXRpbWUuc2xlZXAoMTAwMDAwKQoJCWlmIGVudGVyID09ICI1IjoKCQkJb3Muc3lzdGVtKCdjbGVhcicgb3IgImNscyIpCgkJCXByaW50KEZvcmUuR1JFRU4rIlsrXSBNeSBJUCDCrCIpCgkJCXByaW50KEZvcmUuR1JFRU4rIlsrXS0+IEBDaXBoZXJYIMKsIikKCQkJcHJpbnQoRm9yZS5SRUQrIjw9PT09PT09PT0+IikKCQkJaXBMID0gcmVxdWVzdHMuZ2V0KCJodHRwczovL2dldC5nZW9qcy5pby92MS9pcC5qc29uIikKCQkJbXlfaXAgPSBpcEwuanNvbigpWyJpcCJdCgkJCXByaW50KEZvcmUuR1JFRU4rIllvdXIgSVAgPT4ge30iLmZvcm1hdChGb3JlLlJFRCtteV9pcCkpCgkJCU1lbnUgPSBzdHIoaW5wdXQoRm9yZS5SRUQrIiggQmFjayBNZW51IDwgOTkgPiApID0+ICIpKQoJCQlpZiBNZW51ID09ICI5OSI6CgkJCQlvcy5zeXN0ZW0oImNsZWFyIikKCQkJCVN0YXJ0KCkKCQkJdGltZS5zbGVlcCg0MDAwMDApCgkJaWYgZW50ZXIgPT0gIjYiOgoJCQlvcy5zeXN0ZW0oJ2NsZWFyJykKCQkJcHJpbnQoRm9yZS5SRUQrIkdvb2QgQmV5IDopICIpCgkJCXN5cy5leGl0KCkKCQllbHNlOgoJCQlvcy5zeXN0ZW0oImNsZWFyIikKCQkJU3RhcnQoKQoJZXhjZXB0IEtleWJvYXJkSW50ZXJydXB0OgoJCW9zLnN5c3RlbSgiY2xlYXIiKQoJCXByaW50KEZvcmUuUkVEKyJbIE1FIF0gQENpcGhlclgiKQoJCXByaW50KEZvcmUuR1JFRU4rIlsgI0NpcGhlclggXSIpCm5ldCA9IHJlcXVlc3RzLmdldCgiaHR0cHM6Ly9nb29nbGUuY29tIikKY29ubmVjdCA9IG5ldC5zdGF0dXNfY29kZQppZiBjb25uZWN0ID09IDIwMDoKCVN0YXJ0KCkKZWxzZToKCW9zLnN5c3RlbSgiY2xlYXIiKQoJcHJpbnQoRm9yZS5SRUQrIk5vdCBpbnRlcm5ldCEiKQoJc3lzLmV4aXQoKQoKCg=="))